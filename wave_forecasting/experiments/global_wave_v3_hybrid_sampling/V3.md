📈 Training for 100 epochs...
   Each epoch: 200 samples
   Learning rate: 5e-05 (with warmup)
   Gradient clipping: 5.0

Epoch 1/100
   Learning rate: 5.00e-06 (warmup)

   Batch 0 raw data:
     Input shape: torch.Size([2, 4, 40962, 16])
     Input range: [-39.840, 104652.203]
     Target range: [0.000, 359.364]

   Batch 1 raw data:
     Input shape: torch.Size([2, 4, 40962, 16])
     Input range: [-49.017, 104595.797]
     Target range: [0.000, 359.415]

   Batch 2 raw data:
     Input shape: torch.Size([2, 4, 40962, 16])
     Input range: [-50.630, 104933.656]
     Target range: [0.000, 358.430]

   🔍 Epoch diagnostic summary:
      Total batches: 100
      Valid batches: 100
      NaN after norm: 0
      Inf after norm: 0
      NaN predictions: 0
      NaN losses: 0
      Inf losses: 0
      Loss range: [1.0889, 1.7961]
      Mean loss: 1.3605
   Train Loss: 5.4418
   Val Loss: 2.3014
   Val Loss by variable: SWH=1.2677, MWD=0.6955, MWP=0.3382
   Time: 28194.2s (469.9 min)
   💾 Saved: best_model.pt

Epoch 2/100
   Learning rate: 1.40e-05 (warmup)

🎲 Resampling epoch data...
   Sampled 200 sequences
   Seasonal distribution: {'summer': 48, 'spring': 53, 'winter': 49, 'fall': 50}

   Batch 0 raw data:
     Input shape: torch.Size([2, 4, 40962, 16])
     Input range: [-62.536, 105901.148]
     Target range: [0.000, 359.519]

   Batch 1 raw data:
     Input shape: torch.Size([2, 4, 40962, 16])
     Input range: [-51.403, 103722.406]
     Target range: [0.000, 358.799]

   Batch 2 raw data:
     Input shape: torch.Size([2, 4, 40962, 16])
     Input range: [-55.024, 105475.344]
     Target range: [0.000, 359.479]

   🔍 Epoch diagnostic summary:
      Total batches: 100
      Valid batches: 100
      NaN after norm: 0
      Inf after norm: 0
      NaN predictions: 0
      NaN losses: 0
      Inf losses: 0
      Loss range: [0.7923, 1.2692]
      Mean loss: 1.0158
   Train Loss: 4.0631
   Val Loss: 1.7320
   Val Loss by variable: SWH=0.9794, MWD=0.4780, MWP=0.2747
   Time: 30374.4s (506.2 min)
   💾 Saved: best_model.pt

Epoch 3/100
   Learning rate: 2.30e-05 (warmup)

🎲 Resampling epoch data...
   Sampled 200 sequences
   Seasonal distribution: {'fall': 50, 'spring': 49, 'winter': 52, 'summer': 49}

   Batch 0 raw data:
     Input shape: torch.Size([2, 4, 40962, 16])
     Input range: [-53.377, 105185.812]
     Target range: [0.000, 359.236]

   Batch 1 raw data:
     Input shape: torch.Size([2, 4, 40962, 16])
     Input range: [-44.249, 105060.148]
     Target range: [0.000, 359.346]

   Batch 2 raw data:
     Input shape: torch.Size([2, 4, 40962, 16])
     Input range: [-45.741, 104652.805]
     Target range: [0.000, 359.352]

   🔍 Epoch diagnostic summary:
      Total batches: 100
      Valid batches: 100
      NaN after norm: 0
      Inf after norm: 0
      NaN predictions: 0
      NaN losses: 0
      Inf losses: 0
      Loss range: [0.5387, 1.0633]
      Mean loss: 0.7873
   Train Loss: 3.1493
   Val Loss: 1.2008
   Val Loss by variable: SWH=0.6287, MWD=0.3652, MWP=0.2068
   Time: 31796.9s (529.9 min)
   💾 Saved: best_model.pt